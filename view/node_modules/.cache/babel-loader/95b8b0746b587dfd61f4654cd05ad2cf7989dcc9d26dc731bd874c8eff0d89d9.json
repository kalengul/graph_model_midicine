{"ast":null,"code":"/* global AFRAME, THREE */\n/* eslint-disable no-prototype-builtins */\nrequire('../../lib/keyboard.polyfill');\nconst PROXY_FLAG = '__keyboard-controls-proxy';\nconst KeyboardEvent = window.KeyboardEvent;\n\n/**\n * Keyboard Controls component.\n *\n * Stripped-down version of: https://github.com/donmccurdy/aframe-keyboard-controls\n *\n * Bind keyboard events to components, or control your entities with the WASD keys.\n *\n * Why use KeyboardEvent.code? \"This is set to a string representing the key that was pressed to\n * generate the KeyboardEvent, without taking the current keyboard layout (e.g., QWERTY vs.\n * Dvorak), locale (e.g., English vs. French), or any modifier keys into account. This is useful\n * when you care about which physical key was pressed, rather thanwhich character it corresponds\n * to. For example, if you’re a writing a game, you might want a certain set of keys to move the\n * player in different directions, and that mapping should ideally be independent of keyboard\n * layout. See: https://developers.google.com/web/updates/2016/04/keyboardevent-keys-codes\n *\n * @namespace wasd-controls\n * keys the entity moves and if you release it will stop. Easing simulates friction.\n * to the entity when pressing the keys.\n * @param {bool} [enabled=true] - To completely enable or disable the controls\n */\nmodule.exports = AFRAME.registerComponent('keyboard-controls', {\n  schema: {\n    enabled: {\n      default: true\n    },\n    debug: {\n      default: false\n    }\n  },\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.localKeys = {};\n    this.listeners = {\n      keydown: this.onKeyDown.bind(this),\n      keyup: this.onKeyUp.bind(this),\n      blur: this.onBlur.bind(this),\n      onContextMenu: this.onContextMenu.bind(this)\n    };\n  },\n  /*******************************************************************\n  * Movement\n  */\n\n  isVelocityActive: function () {\n    return this.data.enabled && !!Object.keys(this.getKeys()).length;\n  },\n  getVelocityDelta: function () {\n    const data = this.data;\n    const keys = this.getKeys();\n    this.dVelocity.set(0, 0, 0);\n    if (data.enabled) {\n      if (keys.KeyW || keys.ArrowUp) {\n        this.dVelocity.z -= 1;\n      }\n      if (keys.KeyA || keys.ArrowLeft) {\n        this.dVelocity.x -= 1;\n      }\n      if (keys.KeyS || keys.ArrowDown) {\n        this.dVelocity.z += 1;\n      }\n      if (keys.KeyD || keys.ArrowRight) {\n        this.dVelocity.x += 1;\n      }\n\n      // Move faster when the shift key is down.\n      if (keys.ShiftLeft) {\n        this.dVelocity = this.dVelocity.multiplyScalar(2);\n      }\n    }\n    return this.dVelocity.clone();\n  },\n  /*******************************************************************\n  * Events\n  */\n\n  play: function () {\n    this.attachEventListeners();\n  },\n  pause: function () {\n    this.removeEventListeners();\n  },\n  attachEventListeners: function () {\n    window.addEventListener(\"contextmenu\", this.listeners.onContextMenu, false);\n    window.addEventListener(\"keydown\", this.listeners.keydown, false);\n    window.addEventListener(\"keyup\", this.listeners.keyup, false);\n    window.addEventListener(\"blur\", this.listeners.blur, false);\n  },\n  onContextMenu: function () {\n    for (const code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n  removeEventListeners: function () {\n    window.removeEventListener('keydown', this.listeners.keydown);\n    window.removeEventListener('keyup', this.listeners.keyup);\n    window.removeEventListener('blur', this.listeners.blur);\n  },\n  onKeyDown: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      this.localKeys[event.code] = true;\n      this.emit(event);\n    }\n  },\n  onKeyUp: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      delete this.localKeys[event.code];\n      this.emit(event);\n    }\n  },\n  onBlur: function () {\n    for (const code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n  emit: function (event) {\n    // TODO - keydown only initially?\n    // TODO - where the f is the spacebar\n\n    // Emit original event.\n    if (PROXY_FLAG in event) {\n      // TODO - Method never triggered.\n      this.el.emit(event.type, event);\n    }\n\n    // Emit convenience event, identifying key.\n    this.el.emit(event.type + ':' + event.code, new KeyboardEvent(event.type, event));\n    if (this.data.debug) console.log(event.type + ':' + event.code);\n  },\n  /*******************************************************************\n  * Accessors\n  */\n\n  isPressed: function (code) {\n    return code in this.getKeys();\n  },\n  getKeys: function () {\n    if (this.isProxied()) {\n      return this.el.sceneEl.components['proxy-controls'].getKeyboard();\n    }\n    return this.localKeys;\n  },\n  isProxied: function () {\n    const proxyControls = this.el.sceneEl.components['proxy-controls'];\n    return proxyControls && proxyControls.isConnected();\n  }\n});","map":{"version":3,"names":["require","PROXY_FLAG","KeyboardEvent","window","module","exports","AFRAME","registerComponent","schema","enabled","default","debug","init","dVelocity","THREE","Vector3","localKeys","listeners","keydown","onKeyDown","bind","keyup","onKeyUp","blur","onBlur","onContextMenu","isVelocityActive","data","Object","keys","getKeys","length","getVelocityDelta","set","KeyW","ArrowUp","z","KeyA","ArrowLeft","x","KeyS","ArrowDown","KeyD","ArrowRight","ShiftLeft","multiplyScalar","clone","play","attachEventListeners","pause","removeEventListeners","addEventListener","code","hasOwnProperty","removeEventListener","event","utils","shouldCaptureKeyEvent","emit","el","type","console","log","isPressed","isProxied","sceneEl","components","getKeyboard","proxyControls","isConnected"],"sources":["C:/UsersFolders/Polina/РЭУ/Graph/view/node_modules/aframe-extras/src/controls/keyboard-controls.js"],"sourcesContent":["/* global AFRAME, THREE */\n/* eslint-disable no-prototype-builtins */\nrequire('../../lib/keyboard.polyfill');\n\nconst PROXY_FLAG = '__keyboard-controls-proxy';\n\nconst KeyboardEvent = window.KeyboardEvent;\n\n/**\n * Keyboard Controls component.\n *\n * Stripped-down version of: https://github.com/donmccurdy/aframe-keyboard-controls\n *\n * Bind keyboard events to components, or control your entities with the WASD keys.\n *\n * Why use KeyboardEvent.code? \"This is set to a string representing the key that was pressed to\n * generate the KeyboardEvent, without taking the current keyboard layout (e.g., QWERTY vs.\n * Dvorak), locale (e.g., English vs. French), or any modifier keys into account. This is useful\n * when you care about which physical key was pressed, rather thanwhich character it corresponds\n * to. For example, if you’re a writing a game, you might want a certain set of keys to move the\n * player in different directions, and that mapping should ideally be independent of keyboard\n * layout. See: https://developers.google.com/web/updates/2016/04/keyboardevent-keys-codes\n *\n * @namespace wasd-controls\n * keys the entity moves and if you release it will stop. Easing simulates friction.\n * to the entity when pressing the keys.\n * @param {bool} [enabled=true] - To completely enable or disable the controls\n */\nmodule.exports = AFRAME.registerComponent('keyboard-controls', {\n  schema: {\n    enabled:           { default: true },\n    debug:             { default: false }\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.localKeys = {};\n    this.listeners = {\n      keydown: this.onKeyDown.bind(this),\n      keyup: this.onKeyUp.bind(this),\n      blur: this.onBlur.bind(this),\n      onContextMenu: this.onContextMenu.bind(this),\n    };\n  },\n\n  /*******************************************************************\n  * Movement\n  */\n\n  isVelocityActive: function () {\n    return this.data.enabled && !!Object.keys(this.getKeys()).length;\n  },\n\n  getVelocityDelta: function () {\n    const data = this.data;\n    const keys = this.getKeys();\n\n    this.dVelocity.set(0, 0, 0);\n    if (data.enabled) {\n      if (keys.KeyW || keys.ArrowUp)    { this.dVelocity.z -= 1; }\n      if (keys.KeyA || keys.ArrowLeft)  { this.dVelocity.x -= 1; }\n      if (keys.KeyS || keys.ArrowDown)  { this.dVelocity.z += 1; }\n      if (keys.KeyD || keys.ArrowRight) { this.dVelocity.x += 1; }\n\n      // Move faster when the shift key is down.\n      if (keys.ShiftLeft) { this.dVelocity = this.dVelocity.multiplyScalar(2); }\n    }\n\n    return this.dVelocity.clone();\n  },\n\n  /*******************************************************************\n  * Events\n  */\n\n  play: function () {\n    this.attachEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n  },\n\n  attachEventListeners: function () {\n    window.addEventListener(\"contextmenu\", this.listeners.onContextMenu, false);\n    window.addEventListener(\"keydown\", this.listeners.keydown, false);\n    window.addEventListener(\"keyup\", this.listeners.keyup, false);\n    window.addEventListener(\"blur\", this.listeners.blur, false);\n  },\n\n  onContextMenu: function () {\n    for (const code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n\n  removeEventListeners: function () {\n    window.removeEventListener('keydown', this.listeners.keydown);\n    window.removeEventListener('keyup', this.listeners.keyup);\n    window.removeEventListener('blur', this.listeners.blur);\n  },\n\n  onKeyDown: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      this.localKeys[event.code] = true;\n      this.emit(event);\n    }\n  },\n\n  onKeyUp: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      delete this.localKeys[event.code];\n      this.emit(event);\n    }\n  },\n\n  onBlur: function () {\n    for (const code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n\n  emit: function (event) {\n    // TODO - keydown only initially?\n    // TODO - where the f is the spacebar\n\n    // Emit original event.\n    if (PROXY_FLAG in event) {\n      // TODO - Method never triggered.\n      this.el.emit(event.type, event);\n    }\n\n    // Emit convenience event, identifying key.\n    this.el.emit(event.type + ':' + event.code, new KeyboardEvent(event.type, event));\n    if (this.data.debug) console.log(event.type + ':' + event.code);\n  },\n\n  /*******************************************************************\n  * Accessors\n  */\n\n  isPressed: function (code) {\n    return code in this.getKeys();\n  },\n\n  getKeys: function () {\n    if (this.isProxied()) {\n      return this.el.sceneEl.components['proxy-controls'].getKeyboard();\n    }\n    return this.localKeys;\n  },\n\n  isProxied: function () {\n    const proxyControls = this.el.sceneEl.components['proxy-controls'];\n    return proxyControls && proxyControls.isConnected();\n  }\n\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}