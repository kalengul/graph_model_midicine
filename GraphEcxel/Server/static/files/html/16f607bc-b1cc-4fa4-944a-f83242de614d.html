<!DOCTYPE html>
<html>
    <head>
        <title>9aa4486f-659a-4e7b-a966-03d0c3b9389c</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="./css/index.css">
        <style>
            .Graphcontainer{
                width: 98%;
                height: 85vh;

                border: solid 0.5px black;
                border-radius: 7px;
            }

            .svgGraph{
                width: 100%;
                height: 100%;
            }   
        </style>
        <script src="./d3.v7.js"></script>
    </head>
    <body>
        <main>
            <div class="flex jc-center">
                <h1>9aa4486f-659a-4e7b-a966-03d0c3b9389c</h1>
            </div>
            <br/>
            <div class='Graphcontainer' >
                <svg class='svgGraph'> </svg>
            </div>
        </main>

        <script>
            const colors = {
                selectNode: "#E8BD6D",
                selectLink: "#8B7474",
                node: "#E9EEF4",
                link: '#B8B5B5'
            }

            const nodeView = {
                r: 30
            }

            const graphData = {"directed":true,"multigraph":false,"graph":{},"nodes":[{"name":"бронхоспазм","label":"side_e","weight":5,"id":"95c0988a-70e7-4789-902a-8f16db5e18fd","level":3,"r":30,"y":532.8571428571429,"x":19.672131147540984},{"name":"шок (у пациент с бронхиальный астма)","label":"side_e","weight":5,"id":"7af4c77b-760a-48e4-a04d-d6d8a3170143","level":3,"r":30,"y":532.8571428571429,"x":99.67213114754098},{"name":"тревожность","label":"side_e","weight":5,"id":"7f4cc51c-eff5-4d20-8db5-9dce88d8c15c","level":3,"r":30,"y":532.8571428571429,"x":179.672131147541},{"name":"двигательный беспокойство","label":"side_e","weight":5,"id":"66be4486-20e4-4a2e-ab05-032e75a8fa74","level":3,"r":30,"y":532.8571428571429,"x":259.672131147541},{"name":"тремор палец рука","label":"side_e","weight":5,"id":"8f76ffd4-9ce0-4aae-958d-19566eca9266","level":3,"r":30,"y":532.8571428571429,"x":339.672131147541},{"name":"мидриаз","label":"side_e","weight":5,"id":"f8884d9d-911e-4f9f-8627-2781b1c11532","level":3,"r":30,"y":532.8571428571429,"x":419.672131147541},{"name":"экстрасистолия","label":"side_e","weight":5,"id":"b3403d82-4d38-4c78-9cd3-f852ced81167","level":3,"r":30,"y":532.8571428571429,"x":499.672131147541},{"name":"стенокардия","label":"side_e","weight":5,"id":"000f808d-7936-4105-9ea4-c810fb459d23","level":3,"r":30,"y":532.8571428571429,"x":579.672131147541},{"name":"тахикардия","label":"side_e","weight":5,"id":"14e876d1-6f14-40c0-acf5-e8de162f5e18","level":3,"r":30,"y":532.8571428571429,"x":659.672131147541},{"name":"боль за грудина","label":"side_e","weight":5,"id":"0f075a56-ffae-4d28-9ded-6c74800c4da5","level":3,"r":30,"y":532.8571428571429,"x":739.672131147541},{"name":"нарушение проводимость сердце","label":"side_e","weight":5,"id":"78810f4e-626f-4a33-a3fb-7aa47bce1919","level":3,"r":30,"y":532.8571428571429,"x":819.672131147541},{"name":"расширение комплекс qrs на экг","label":"side_e","weight":5,"id":"5aab684d-d6df-483b-8344-167ce30d128d","level":3,"r":30,"y":532.8571428571429,"x":899.672131147541},{"name":"повышение конечный диастолический давление в левый желудочек","label":"side_e","weight":5,"id":"35aa2ae0-f8d7-4265-8388-9f2e5b0b3ef9","level":3,"r":30,"y":532.8571428571429,"x":979.672131147541},{"name":"желудочковый или наджелудочковый аритмия","label":"side_e","weight":5,"id":"d5bd6bf7-c6c2-475d-9500-ad4f1ae0e0e2","level":3,"r":30,"y":532.8571428571429,"x":1059.672131147541},{"name":"вазоспазм","label":"side_e","weight":5,"id":"dfe2baa1-05da-470f-871a-41760ce3cc98","level":3,"r":30,"y":532.8571428571429,"x":1139.672131147541},{"name":"флебит","label":"side_e","weight":5,"id":"5ee6dfd6-b16b-4d2e-8201-4a203250cc78","level":3,"r":30,"y":532.8571428571429,"x":1219.672131147541},{"name":"одышка","label":"side_e","weight":5,"id":"6f98e4b3-0c54-431a-8e19-3ed9e09402c3","level":3,"r":30,"y":532.8571428571429,"x":1299.672131147541},{"name":"тошнота","label":"side_e","weight":5,"id":"42395761-e592-4873-b234-9b89b86a2b67","level":3,"r":30,"y":532.8571428571429,"x":1379.672131147541},{"name":"рвота","label":"side_e","weight":5,"id":"15ef2807-6e76-4172-83ba-11da4d007587","level":3,"r":30,"y":532.8571428571429,"x":1459.672131147541},{"name":"кровотечение из желудочнокишечный тракт","label":"side_e","weight":5,"id":"4ace1643-5841-4d86-93a4-09a08b4b47fb","level":3,"r":30,"y":532.8571428571429,"x":1539.672131147541},{"name":"пилоэрекция","label":"side_e","weight":5,"id":"3d4c1f60-c095-41f8-996d-9d704927a58b","level":3,"r":30,"y":532.8571428571429,"x":1619.672131147541},{"name":"азотемия","label":"side_e","weight":5,"id":"773f8539-9036-4d34-acb5-b7afa11044da","level":3,"r":30,"y":532.8571428571429,"x":1699.672131147541},{"name":"полиурия","label":"side_e","weight":5,"id":"ae6eda13-ac17-473f-a2e5-3d04497ffca9","level":3,"r":30,"y":532.8571428571429,"x":1779.672131147541},{"name":"болезненность в место введение","label":"side_e","weight":5,"id":"c4380051-1a9f-470b-a3ba-fc202b10c9d5","level":3,"r":30,"y":532.8571428571429,"x":1859.672131147541},{"name":"некроз кожа и подкожный клетчатка","label":"side_e","weight":5,"id":"0ec27861-f776-448f-b694-65f3bb8a89eb","level":3,"r":30,"y":532.8571428571429,"x":1939.672131147541},{"name":"реакция гиперчувствительность","label":"side_e","weight":5,"id":"fdefd0fd-2846-4aae-9b8d-553a579d071e","level":3,"r":30,"y":532.8571428571429,"x":2019.672131147541},{"name":"изменение световосприятие","label":"side_e","weight":5,"id":"8c4ce179-1030-4f04-b3d1-99cfbf088056","level":3,"r":30,"y":532.8571428571429,"x":2099.672131147541},{"name":"изменение световосприятие (фотопсия)","label":"side_e","weight":5,"id":"90621355-b88f-498c-8eb5-8259b94e6a20","level":3,"r":30,"y":532.8571428571429,"x":2179.672131147541},{"name":"диплопия","label":"side_e","weight":5,"id":"0b9106e5-3a3d-46ad-8c36-05990a9b0ddf","level":3,"r":30,"y":532.8571428571429,"x":2259.672131147541},{"name":"вертиго","label":"side_e","weight":5,"id":"e242afe2-91b8-450f-9dc0-967dbb78c2f6","level":3,"r":30,"y":532.8571428571429,"x":2339.672131147541},{"name":"выраженный брадикардия с чсс не более 40 уд/мина","label":"side_e","weight":5,"id":"217b6895-9aa5-40b7-8459-c183205699da","level":3,"r":30,"y":532.8571428571429,"x":2419.672131147541},{"name":"неконтролируемый изменение ад","label":"side_e","weight":5,"id":"349b11f5-cdc6-471c-bf45-5a98ac989c66","level":3,"r":30,"y":532.8571428571429,"x":2499.672131147541},{"name":"наджелудочковый экстрасистолия","label":"side_e","weight":5,"id":"107e7478-c48d-463d-80d4-851fc1b34615","level":3,"r":30,"y":532.8571428571429,"x":2579.672131147541},{"name":"выраженный снижение ад","label":"side_e","weight":5,"id":"786d2ad4-b4a3-4e61-b5b9-9b0afca697de","level":3,"r":30,"y":532.8571428571429,"x":2659.672131147541},{"name":"av блокада ii и iii степень","label":"side_e","weight":5,"id":"1bcde003-7081-4a32-a578-1bac2df44627","level":3,"r":30,"y":532.8571428571429,"x":2739.672131147541},{"name":"синдром слабость синусовый узел","label":"side_e","weight":5,"id":"d2625bb7-bee8-4330-af09-07978afb06a0","level":3,"r":30,"y":532.8571428571429,"x":2819.672131147541},{"name":"запор","label":"side_e","weight":5,"id":"7ff9a405-d81a-4055-9538-b03db5423c43","level":3,"r":30,"y":532.8571428571429,"x":2899.672131147541},{"name":"диарея","label":"side_e","weight":5,"id":"1b14d72b-2db7-4670-a52e-cd0ae18b59b8","level":3,"r":30,"y":532.8571428571429,"x":2979.672131147541},{"name":"боль в живот","label":"side_e","weight":5,"id":"333ff7e1-dc62-4dd9-88ca-4a52871599c8","level":3,"r":30,"y":532.8571428571429,"x":3059.672131147541},{"name":"кожный сыпь","label":"side_e","weight":5,"id":"a65ed320-44d5-462b-84b4-0bed80b6a49c","level":3,"r":30,"y":532.8571428571429,"x":3139.672131147541},{"name":"эритема","label":"side_e","weight":5,"id":"21a92f7c-556b-477a-ba40-e6e172f0d418","level":3,"r":30,"y":532.8571428571429,"x":3219.672131147541},{"name":"кожный зуд","label":"side_e","weight":5,"id":"9c2643ba-73b4-4352-ac7a-edf58fbf23f9","level":3,"r":30,"y":532.8571428571429,"x":3299.672131147541},{"name":"ангионевротический отёк","label":"side_e","weight":5,"id":"4e66fd79-5eba-4762-82bc-bcc543219366","level":3,"r":30,"y":532.8571428571429,"x":3379.672131147541},{"name":"крапивница","label":"side_e","weight":5,"id":"19531263-0e54-4ad5-a5b2-5aca0e47b115","level":3,"r":30,"y":532.8571428571429,"x":3459.672131147541},{"name":"спазм мышца","label":"side_e","weight":5,"id":"52a68df8-6916-453a-ba44-434b02333b65","level":3,"r":30,"y":532.8571428571429,"x":3539.672131147541},{"name":"недомогание, возможно, связанный с брадикардия","label":"side_e","weight":5,"id":"daef10e4-612c-42fd-b8d6-f32de30208fd","level":3,"r":30,"y":532.8571428571429,"x":3619.672131147541},{"name":"гиперурикемия","label":"side_e","weight":5,"id":"c03dc432-9446-496f-b9d7-cd453c7fabe3","level":3,"r":30,"y":532.8571428571429,"x":3699.672131147541},{"name":"эозинофилия","label":"side_e","weight":5,"id":"b3ec87db-c97a-4e2b-b69e-ce0943378d3c","level":3,"r":30,"y":532.8571428571429,"x":3779.672131147541},{"name":"повышение концентрация креатинин","label":"side_e","weight":5,"id":"871dfdef-b2ef-46ad-b7a6-695245868a6d","level":3,"r":30,"y":532.8571428571429,"x":3859.672131147541},{"name":"удлинение интервал qt на экг","label":"side_e","weight":5,"id":"b59906bf-72d7-455f-bbbd-f3e52679b02b","level":3,"r":30,"y":532.8571428571429,"x":3939.672131147541},{"name":"гипокалиемия","label":"side_e","weight":5,"id":"2366edf3-ba69-4ca0-a021-19c62511496c","level":3,"r":30,"y":532.8571428571429,"x":4019.672131147541},{"name":"аритмия","label":"side_e","weight":5,"id":"c6c2d21b-8390-41b4-a3fc-1e0214790712","level":3,"r":30,"y":532.8571428571429,"x":4099.672131147541},{"name":"средство для лечение заболевание сердце","label":"group","weight":5,"id":"674d2f0e-b105-4987-8866-e81fe92f13b8","level":0,"r":30,"y":142.85714285714286,"x":1200},{"name":"другой препарат для лечение заболевание сердце","label":"group","weight":5,"id":"b5ad4991-1f40-4b8b-b3e0-b14a8e711a52","level":1,"r":30,"y":272.8571428571429,"x":1200},{"name":"ингибирование if-канал синусовый узел","label":"mechanism","weight":5,"id":"d62d4a3a-bfc2-412a-ad52-2c8de98744a8","level":3,"r":30,"y":532.8571428571429,"x":4179.672131147541},{"name":"ивабрадин","label":"prepare","weight":5,"id":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","level":2,"r":30,"y":402.85714285714283,"x":1200},{"name":"урежение чсс","label":"action","weight":5,"id":"af037a89-de07-4c1e-81db-ed3eb009400b","level":4,"r":30,"y":662.8571428571429,"x":171.42857142857142},{"name":"av блокада i степень","label":"side_e","weight":5,"id":"06ea2676-0884-4b7b-8c65-ffee2a684dcb","level":5,"r":30,"y":792.8571428571429,"x":200},{"name":"брадикардия","label":"side_e","weight":5,"id":"56400a54-b540-48cf-948a-3c116f350955","level":5,"r":30,"y":792.8571428571429,"x":280},{"name":"выраженный брадикардия","label":"side_e","weight":5,"id":"f108a2de-4870-4286-b341-ed4883974690","level":6,"r":30,"y":922.8571428571429,"x":171.42857142857142},{"name":"обморок","label":"side_e","weight":5,"id":"c55c1782-c9bf-41b9-a5d5-e3a73c78b7ca","level":6,"r":30,"y":922.8571428571429,"x":251.42857142857142},{"name":"головокружение","label":"side_e","weight":5,"id":"7a1a9fba-536f-46ca-9ff7-034b59f7e789","level":6,"r":30,"y":922.8571428571429,"x":331.42857142857144},{"name":"повышение или снижение ад","label":"side_e","weight":5,"id":"c40d23e2-2cf1-43e1-9d62-a50e13388937","level":3,"r":30,"y":532.8571428571429,"x":4259.672131147541},{"name":"снижение ад","label":"side_e","weight":5,"id":"818ebc3c-a5d4-4ef8-9cf9-8b68edb1d75d","level":6,"r":30,"y":922.8571428571429,"x":411.42857142857144},{"name":"головной боль","label":"side_e","weight":5,"id":"d3fb56ed-26d4-4511-a93d-44307666d318","level":6,"r":30,"y":922.8571428571429,"x":491.42857142857144},{"name":"ингибирование ih-канал","label":"mechanism","weight":5,"id":"bfa56bf5-8aaa-4bb7-a1e7-87322255199f","level":3,"r":30,"y":532.8571428571429,"x":4339.672131147541},{"name":"изменение реакция сетчатка на яркий световой стимул","label":"mechanism","weight":5,"id":"746dd264-a900-4d19-8c34-a357bf4ccb61","level":4,"r":30,"y":662.8571428571429,"x":251.42857142857142},{"name":"фотопсия","label":"side_e","weight":5,"id":"1ce5e7aa-f5c7-44b2-84e8-e9505efd5d46","level":5,"r":30,"y":792.8571428571429,"x":360},{"name":"фосфен","label":"side_e","weight":5,"id":"c84f4bde-1388-4bee-8eb6-a2ef0900e9f7","level":5,"r":30,"y":792.8571428571429,"x":440},{"name":"нечёткость зрение","label":"side_e","weight":5,"id":"f0def8fe-5e0f-4094-b09b-bb7df0533e17","level":4,"r":30,"y":662.8571428571429,"x":331.42857142857144},{"name":"фибрилляция предсердие","label":"side_e","weight":5,"id":"a0a90942-dc46-40b5-8f27-fd4199cb650f","level":4,"r":30,"y":662.8571428571429,"x":411.42857142857144},{"name":"желудочковый экстрасистолия","label":"side_e","weight":5,"id":"0dd17a0a-f9d3-482a-8ddb-a219009523d8","level":4,"r":30,"y":662.8571428571429,"x":491.42857142857144},{"name":"астения","label":"side_e","weight":5,"id":"cbab84f9-734e-4758-bd4a-b5ac4c1583ca","level":6,"r":30,"y":922.8571428571429,"x":571.4285714285714},{"name":"повышенный утомляемость","label":"side_e","weight":5,"id":"126d2c6f-90ab-45d9-911c-d9a3128b9500","level":6,"r":30,"y":922.8571428571429,"x":651.4285714285714},{"name":"ощущение сердцебиение","label":"side_e","weight":5,"id":"3de8504b-69b9-4acc-9ff0-305aee12949d","level":4,"r":30,"y":662.8571428571429,"x":571.4285714285714},{"name":"белками плазмы крови","label":"prot_link","weight":5,"id":"845f5152-8de5-4644-8b7c-0ce5fa1f08dd","level":3,"r":30,"y":532.8571428571429,"x":4419.672131147541},{"name":"кишечник","label":"metabol","weight":5,"id":"51ef4022-d9ec-42a6-aaff-85968ebdf593","level":3,"r":30,"y":532.8571428571429,"x":4499.672131147541},{"name":"печень","label":"metabol","weight":5,"id":"076549ca-3b9f-460c-9eb8-ecaeea9a1491","level":3,"r":30,"y":532.8571428571429,"x":4579.672131147541},{"name":"cyp3a4","label":"metabol","weight":5,"id":"8d4b7b18-73d0-4812-8d79-5ea21c700210","level":4,"r":30,"y":662.8571428571429,"x":651.4285714285714},{"name":"почка","label":"excretion","weight":5,"id":"78e1a7df-5b6d-4f1b-94e5-632339155793","level":3,"r":30,"y":532.8571428571429,"x":4659.672131147541},{"name":"кишечник","label":"excretion","weight":5,"id":"8e950efd-4375-4bdd-b08c-b7a4fabd8daa","level":3,"r":30,"y":532.8571428571429,"x":4739.672131147541},{"name":"эффект антиангинальный","label":"action","weight":5,"id":"c382d17d-552b-4599-9def-9466610849d9","level":5,"r":30,"y":792.8571428571429,"x":520},{"name":"эффект антиишемический","label":"action","weight":5,"id":"6bc60d6c-28de-4659-87cc-6508eedcb373","level":5,"r":30,"y":792.8571428571429,"x":600},{"name":"ингибирование ih-канал сетчатка глаз","label":"mechanism","weight":5,"id":"18ac6341-1889-418f-b322-072efbc431c6","level":3,"r":30,"y":532.8571428571429,"x":4819.672131147541}],"links":[{"source":"674d2f0e-b105-4987-8866-e81fe92f13b8","target":"b5ad4991-1f40-4b8b-b3e0-b14a8e711a52"},{"source":"b5ad4991-1f40-4b8b-b3e0-b14a8e711a52","target":"9aa4486f-659a-4e7b-a966-03d0c3b9389c"},{"source":"d62d4a3a-bfc2-412a-ad52-2c8de98744a8","target":"af037a89-de07-4c1e-81db-ed3eb009400b"},{"source":"d62d4a3a-bfc2-412a-ad52-2c8de98744a8","target":"a0a90942-dc46-40b5-8f27-fd4199cb650f"},{"source":"d62d4a3a-bfc2-412a-ad52-2c8de98744a8","target":"0dd17a0a-f9d3-482a-8ddb-a219009523d8"},{"source":"d62d4a3a-bfc2-412a-ad52-2c8de98744a8","target":"3de8504b-69b9-4acc-9ff0-305aee12949d"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"95c0988a-70e7-4789-902a-8f16db5e18fd"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"7af4c77b-760a-48e4-a04d-d6d8a3170143"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"7f4cc51c-eff5-4d20-8db5-9dce88d8c15c"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"66be4486-20e4-4a2e-ab05-032e75a8fa74"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"8f76ffd4-9ce0-4aae-958d-19566eca9266"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"f8884d9d-911e-4f9f-8627-2781b1c11532"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"b3403d82-4d38-4c78-9cd3-f852ced81167"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"000f808d-7936-4105-9ea4-c810fb459d23"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"14e876d1-6f14-40c0-acf5-e8de162f5e18"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"0f075a56-ffae-4d28-9ded-6c74800c4da5"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"78810f4e-626f-4a33-a3fb-7aa47bce1919"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"5aab684d-d6df-483b-8344-167ce30d128d"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"35aa2ae0-f8d7-4265-8388-9f2e5b0b3ef9"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"d5bd6bf7-c6c2-475d-9500-ad4f1ae0e0e2"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"dfe2baa1-05da-470f-871a-41760ce3cc98"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"5ee6dfd6-b16b-4d2e-8201-4a203250cc78"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"6f98e4b3-0c54-431a-8e19-3ed9e09402c3"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"42395761-e592-4873-b234-9b89b86a2b67"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"15ef2807-6e76-4172-83ba-11da4d007587"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"4ace1643-5841-4d86-93a4-09a08b4b47fb"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"3d4c1f60-c095-41f8-996d-9d704927a58b"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"773f8539-9036-4d34-acb5-b7afa11044da"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"ae6eda13-ac17-473f-a2e5-3d04497ffca9"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"c4380051-1a9f-470b-a3ba-fc202b10c9d5"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"0ec27861-f776-448f-b694-65f3bb8a89eb"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"fdefd0fd-2846-4aae-9b8d-553a579d071e"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"8c4ce179-1030-4f04-b3d1-99cfbf088056"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"90621355-b88f-498c-8eb5-8259b94e6a20"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"0b9106e5-3a3d-46ad-8c36-05990a9b0ddf"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"e242afe2-91b8-450f-9dc0-967dbb78c2f6"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"217b6895-9aa5-40b7-8459-c183205699da"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"349b11f5-cdc6-471c-bf45-5a98ac989c66"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"107e7478-c48d-463d-80d4-851fc1b34615"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"786d2ad4-b4a3-4e61-b5b9-9b0afca697de"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"1bcde003-7081-4a32-a578-1bac2df44627"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"d2625bb7-bee8-4330-af09-07978afb06a0"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"7ff9a405-d81a-4055-9538-b03db5423c43"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"1b14d72b-2db7-4670-a52e-cd0ae18b59b8"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"333ff7e1-dc62-4dd9-88ca-4a52871599c8"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"a65ed320-44d5-462b-84b4-0bed80b6a49c"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"21a92f7c-556b-477a-ba40-e6e172f0d418"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"9c2643ba-73b4-4352-ac7a-edf58fbf23f9"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"4e66fd79-5eba-4762-82bc-bcc543219366"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"19531263-0e54-4ad5-a5b2-5aca0e47b115"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"52a68df8-6916-453a-ba44-434b02333b65"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"daef10e4-612c-42fd-b8d6-f32de30208fd"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"c03dc432-9446-496f-b9d7-cd453c7fabe3"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"b3ec87db-c97a-4e2b-b69e-ce0943378d3c"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"871dfdef-b2ef-46ad-b7a6-695245868a6d"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"b59906bf-72d7-455f-bbbd-f3e52679b02b"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"2366edf3-ba69-4ca0-a021-19c62511496c"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"c6c2d21b-8390-41b4-a3fc-1e0214790712"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"c40d23e2-2cf1-43e1-9d62-a50e13388937"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"d62d4a3a-bfc2-412a-ad52-2c8de98744a8"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"bfa56bf5-8aaa-4bb7-a1e7-87322255199f"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"51ef4022-d9ec-42a6-aaff-85968ebdf593"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"076549ca-3b9f-460c-9eb8-ecaeea9a1491"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"845f5152-8de5-4644-8b7c-0ce5fa1f08dd"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"8e950efd-4375-4bdd-b08c-b7a4fabd8daa"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"78e1a7df-5b6d-4f1b-94e5-632339155793"},{"source":"9aa4486f-659a-4e7b-a966-03d0c3b9389c","target":"18ac6341-1889-418f-b322-072efbc431c6"},{"source":"af037a89-de07-4c1e-81db-ed3eb009400b","target":"06ea2676-0884-4b7b-8c65-ffee2a684dcb"},{"source":"af037a89-de07-4c1e-81db-ed3eb009400b","target":"56400a54-b540-48cf-948a-3c116f350955"},{"source":"af037a89-de07-4c1e-81db-ed3eb009400b","target":"c382d17d-552b-4599-9def-9466610849d9"},{"source":"af037a89-de07-4c1e-81db-ed3eb009400b","target":"6bc60d6c-28de-4659-87cc-6508eedcb373"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"f108a2de-4870-4286-b341-ed4883974690"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"c55c1782-c9bf-41b9-a5d5-e3a73c78b7ca"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"7a1a9fba-536f-46ca-9ff7-034b59f7e789"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"818ebc3c-a5d4-4ef8-9cf9-8b68edb1d75d"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"d3fb56ed-26d4-4511-a93d-44307666d318"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"cbab84f9-734e-4758-bd4a-b5ac4c1583ca"},{"source":"56400a54-b540-48cf-948a-3c116f350955","target":"126d2c6f-90ab-45d9-911c-d9a3128b9500"},{"source":"bfa56bf5-8aaa-4bb7-a1e7-87322255199f","target":"f0def8fe-5e0f-4094-b09b-bb7df0533e17"},{"source":"746dd264-a900-4d19-8c34-a357bf4ccb61","target":"1ce5e7aa-f5c7-44b2-84e8-e9505efd5d46"},{"source":"746dd264-a900-4d19-8c34-a357bf4ccb61","target":"c84f4bde-1388-4bee-8eb6-a2ef0900e9f7"},{"source":"076549ca-3b9f-460c-9eb8-ecaeea9a1491","target":"8d4b7b18-73d0-4812-8d79-5ea21c700210"},{"source":"18ac6341-1889-418f-b322-072efbc431c6","target":"746dd264-a900-4d19-8c34-a357bf4ccb61"}],"name":["9aa4486f-659a-4e7b-a966-03d0c3b9389c"],"maxLevel":7,"levelsInfo":{"levelNodesCount":{"0":1,"1":1,"2":1,"3":61,"4":7,"5":6,"6":7}},"isParse":true}
            const window_params = {"width":1200,"height":600,"xStep":50,"yStep":100}

            console.log(graphData)

            

            if (graphData){
                const svg = d3.select("svg")
                svg.selectAll("*").remove() // Очистка предыдущего графа

                svg.attr("width",   window_params.width) //Устанавливает атрибут width
                .attr("height",   window_params.height)
                .append("g").attr('class', 'group') //добавляет новый элемент, тег которого передается в метод в качестве параметра

                const svgGroup = svg.select('g.group')

                // Масштабирование и перемещение
                const zoom = d3.zoom()
                .scaleExtent([0.1, 10])
                .on("zoom", (event)=>{ //Обновление позиционирования элементов при масштабировании
                    svgGroup.attr("transform", event.transform);
                });
                svg.call(zoom);


                const dragstarted = (event, d)=>{
                    if (!event.active) simulation.alphaTarget(0.3).restart(); // Увеличиваем "температуру" симуляции для более плавного движения
                    d.fx = d.x; // Фиксируем позицию узла
                    d.fy = d.y;
                }
                
                const dragged = (event, d)=>{
                    d.fx = event.x; // Обновляем фиксированные координаты узла
                    d.fy = event.y;
                }
                
                const dragended = (event, d)=>{
                    if (!event.active) simulation.alphaTarget(0); // Охлаждаем симуляцию после перетаскивания
                    d.fx = null; // Отпускаем узел, позволяя симуляции снова влиять на его позицию
                    d.fy = null;
                }

                // Создаем обработчик drag
                const drag = d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended);


                // Определение маркера стрелки
                svgGroup.append("defs")
                .append("marker")
                .attr("id", "arrowhead")
                .attr("markerWidth", 5) //Размер области, в которой будет отображаться маркер
                .attr("markerHeight", 4)
                .attr("refX", nodeView.r+4)
                .attr("refY", 2)
                .attr("orient", "auto")
                .append("polygon")
                .attr("points", "0 0, 5 2, 0 4")
                .style("fill", colors.link);

                
                //Добавление ссылок
                let links = svgGroup.append("g").attr('class', 'links')
                .selectAll('.link')
                .data(graphData.links) //Добавление данных
                .enter() //Нужен для ввода дополнительных значений (так как data привязывает только первое)
                .append('path')
                .attr('class', 'link')
                .attr('stroke', d=>{
                    //if((d.source.id === selectedNodes.sourseNode && d.target.id === selectedNodes.targetNode)||(d.target.id === selectedNodes.sourseNode && d.source.id === selectedNodes.targetNode)) return colors.selectLink
                    return colors.link
                }) // Цвет линии ребра
                .attr('stroke-width', d=>{
                    //if((d.source.id === selectedNodes.sourseNode && d.target.id === selectedNodes.targetNode)||(d.target.id === selectedNodes.sourseNode && d.source.id === selectedNodes.targetNode)) return 2
                    return 1
                }) // Ширина линии ребра
                .attr("marker-end", "url(#arrowhead)") // Добавление стрелки в конец ребра
                .style('pointer-events', 'none') //(устанавливает стиль) Отключение событий на ребрах (клики и т.д.)

                // Создание узлов
                let nodes = svgGroup.append("g").attr('class', 'nodes')
                .selectAll('.node')
                .data(graphData.nodes)
                .enter()
                .append('g')
                .attr('class', 'node')
                .call(drag);

                nodes.append('circle')
                .attr('class', 'node')
                .attr('id', d => d.id)
                .attr('r', d => d.r) // Радиус узла
                .attr('fill', d=>{
                    //if(selectedNodes.sourseNode === d.id || selectedNodes.targetNode === d.id) return colors.selectNode
                    return colors.node
                }) // Цвет заполнения
                .attr("cursor", "pointer")
                .on('click', (event, d) => {
                    // Добавьте логику для обработки клика по узлу
                });

                //Отображение текста v2
                nodes.append('foreignObject')
                .attr('x', d => -d.r * 0.8)
                .attr('y', d => -d.r * 0.8)
                .attr('width', d => d.r * 1.6)
                .attr('height', d => d.r * 1.6)
                .append('xhtml:div')
                .style('display', 'flex')
                .style('justify-content', 'center')
                .style('align-items', 'center')
                .style('width', '100%')
                .style('height', '100%')
                .style('font-size', '5px')
                .style('text-anchor', 'middle')
                .style('word-wrap', 'break-word')
                .style('overflow', 'hidden')
                .style('pointer-events', 'none')
                .text(d => d.name);

                //Создание симуляции силы v3
                const simulation = d3.forceSimulation(graphData.nodes)
                // Связи между узлами
                .force("link", d3.forceLink(graphData.links).id(d => d.id))//.distance(nodeView.r*10)) //!!! Сила в зависимости от количества узлов в уровне!!!!!
                // Отталкивание узлов
                .force("charge", d3.forceManyBody(graphData.nodes).strength(d=>graphData.levelsInfo.levelNodesCount[d.level]*(-100)))//-3000))
                // Центрирование по x
                .force("center", d3.forceCenter( window_params.width / 2,  window_params.height / 2))
                // Выравнивание по уровням
                .force("y", d3.forceY().strength(6)
                    .y(d =>  window_params.height * ((d.level+1) / (graphData.maxLevel-1)))) //!!!!!!!!!!Уровень с большим числом узлов шире, чем с меньшим
                // Отталкивание по x в рамках одного уровня
                .force("x", d3.forceX().strength(0.05)
                    .x( window_params.width / 2))
                // Дополнительная сила для предотвращения наложения узлов
                .force("collision", d3.forceCollide().radius(40));

                // Обновление позиций узлов и связей при каждой итерации симуляции
                //Обновление симуляции
                simulation.on('tick', () => {
                    links.attr("d", d => `M${d.source.x},${d.source.y} L${d.target.x},${d.target.y}`);
                    nodes.attr('transform', d => `translate(${d.x}, ${d.y})`); // Правильная позиция для групп
                });
            }
        </script>
    </body>
</html>